var WebMCPAuto=(()=>{var S=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var q=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var H=(t,i)=>{for(var o in i)S(t,o,{get:i[o],enumerable:!0})},W=(t,i,o,n)=>{if(i&&typeof i=="object"||typeof i=="function")for(let e of q(i))!F.call(t,e)&&e!==o&&S(t,e,{get:()=>i[e],enumerable:!(n=j(i,e))||n.enumerable});return t};var D=t=>W(S({},"__esModule",{value:!0}),t);var U={};H(U,{default:()=>B,instrument:()=>k});var I={exclude:[],include:[],prefix:"",onToolRegistered:null,watch:!0,maxTools:50,debug:!0};function m(t){return t.toLowerCase().replace(/[^a-z0-9\s_-]/g,"").replace(/[\s_-]+/g,"_").replace(/^_|_$/g,"").slice(0,40)}function x(t,i,o){let n=[];if(i&&n.push(i),t.getAttribute("toolname"))return null;let e=t.id,s=t.getAttribute("name"),r=t.getAttribute("aria-label"),l=t.getAttribute("action"),u=t.textContent?.trim().slice(0,30);return o==="form"?e?n.push(m(e)):s?n.push(m(s)):l?n.push("submit_"+m(l.split("/").pop())):n.push("form_"+Math.random().toString(36).slice(2,6)):o==="button"?r?n.push(m(r)):u?n.push(m(u)):e?n.push(m(e)):n.push("action_"+Math.random().toString(36).slice(2,6)):o==="link"?r?n.push("navigate_"+m(r)):u?n.push("navigate_"+m(u)):n.push("navigate_"+Math.random().toString(36).slice(2,6)):o==="input"&&(s?n.push("set_"+m(s)):e?n.push("set_"+m(e)):n.push("set_field_"+Math.random().toString(36).slice(2,6))),n.join("_")||null}function A(t,i){let o=t.getAttribute("aria-label"),n=t.getAttribute("title"),e=t.getAttribute("placeholder"),s=t.textContent?.trim().slice(0,50);if(i==="form"){let r=(t.method||"GET").toUpperCase(),l=t.action||"",u=t.querySelectorAll("input, select, textarea"),f=Array.from(u).map(h=>h.name||h.id||h.placeholder).filter(Boolean).slice(0,5),b="Submit a form";return o?b=`Submit: ${o}`:n&&(b=`Submit: ${n}`),f.length>0&&(b+=` (fields: ${f.join(", ")})`),b}if(i==="button")return o?`Click action: ${o}`:n?`Click action: ${n}`:s?`Click: ${s}`:"Trigger a button action";if(i==="link"){let r=t.getAttribute("href")||"";return o?`Navigate to: ${o}`:s?`Navigate to: ${s}`:`Navigate to ${r}`}if(i==="input"){let r=t.type||"text",l=t.name||t.id||"";return e?`Set ${l||"field"}: ${e}`:`Set ${r} field: ${l}`}return"Interact with page element"}function $(t){let i=t.querySelectorAll("input, select, textarea"),o={},n=[];for(let e of i){let s=e.name||e.id;if(!s||e.type==="hidden"||e.type==="submit")continue;let r={type:"string"};switch(e.type){case"number":case"range":r.type="number",e.min&&(r.minimum=parseFloat(e.min)),e.max&&(r.maximum=parseFloat(e.max));break;case"checkbox":r.type="boolean";break;case"email":r.type="string",r.format="email";break;case"url":r.type="string",r.format="uri";break;case"date":r.type="string",r.format="date";break;case"tel":r.type="string",r.format="phone";break;default:r.type="string"}let l=t.querySelector(`label[for="${e.id}"]`);if(l?r.description=l.textContent.trim():e.placeholder&&(r.description=e.placeholder),e.tagName==="SELECT"){let u=Array.from(e.options).map(f=>f.value).filter(f=>f);u.length>0&&u.length<=20&&(r.enum=u)}e.pattern&&(r.pattern=e.pattern),o[s]=r,e.required&&n.push(s)}return{type:"object",properties:o,...n.length>0?{required:n}:{}}}function C(t){return async i=>{let o=t.querySelectorAll("input, select, textarea");for(let n of o){let e=n.name||n.id;if(!e||!(e in i))continue;let s=i[e];n.type==="checkbox"?n.checked=!!s:(n.tagName,n.value=s),n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0}))}return t.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0})),{success:!0,message:`Form submitted with ${Object.keys(i).length} fields`,fields:Object.keys(i)}}}function _(t){return async()=>(t.click(),{success:!0,message:`Clicked: ${t.textContent?.trim().slice(0,50)||"button"}`})}function R(t){return async()=>{let i=t.getAttribute("href");return i&&!i.startsWith("javascript:")?{success:!0,url:new URL(i,window.location.href).toString(),text:t.textContent?.trim().slice(0,50),message:`Link target: ${i}`}:(t.click(),{success:!0,message:"Link activated"})}}function k(t={}){let i={...I,...t},o=new Map,n=0;function e(...a){i.debug&&console.log("%c[webmcp-auto]","color:#F59E0B;font-weight:bold",...a)}function s(a){for(let g of i.exclude)if(a.matches(g)||a.closest(g))return!0;return!1}function r(){return typeof navigator<"u"&&navigator.modelContext?navigator.modelContext:null}function l(a){if(n>=i.maxTools){e(`\u26A0\uFE0F Max tools (${i.maxTools}) reached, skipping: ${a.name}`);return}if(o.has(a.name))return;let g=r();if(g&&g.registerTool)try{g.registerTool(a)}catch(v){e(`\u26A0\uFE0F Failed to register with WebMCP: ${a.name}`,v.message)}o.set(a.name,a),n++,i.onToolRegistered&&i.onToolRegistered(a),e(`\u2705 Registered: ${a.name} \u2014 "${a.description}"`)}function u(){let a=i.prefix;e("\u{1F50D} Scanning page...");let g=document.querySelectorAll("form");for(let c of g){if(s(c)||c.getAttribute("toolname"))continue;let p=x(c,a,"form");if(!p)continue;let d=$(c);Object.keys(d.properties).length!==0&&l({name:p,description:A(c,"form"),inputSchema:d,handler:C(c),annotations:{readOnlyHint:!1,destructiveHint:!1}})}let v=document.querySelectorAll('button:not(form button), [role="button"], input[type="button"]');for(let c of v){if(s(c)||c.closest("form")||!c.textContent?.trim()&&!c.getAttribute("aria-label"))continue;let p=x(c,a,"button");p&&l({name:p,description:A(c,"button"),inputSchema:{type:"object",properties:{}},handler:_(c),annotations:{readOnlyHint:!1}})}let M=document.querySelectorAll("nav a, [role='navigation'] a, header a");for(let c of M){if(s(c))continue;let p=c.getAttribute("href");if(!p||p==="#"||p.startsWith("javascript:"))continue;let d=x(c,a,"link");d&&l({name:d,description:A(c,"link"),inputSchema:{type:"object",properties:{}},handler:R(c),annotations:{readOnlyHint:!0}})}for(let c of i.include){let p=document.querySelectorAll(c);for(let d of p){if(s(d))continue;let y=d.tagName==="FORM"?"form":"button",T=x(d,a,y);if(!T)continue;let L=y==="form"?C(d):_(d),O=y==="form"?$(d):{type:"object",properties:{}};l({name:T,description:A(d,y),inputSchema:O,handler:L})}}e(`\u{1F4E6} Scan complete: ${o.size} tools registered`)}let f=null;function b(){if(!i.watch||typeof MutationObserver>"u")return;let a=null;f=new MutationObserver(()=>{clearTimeout(a),a=setTimeout(()=>{e("\u{1F504} DOM changed, re-scanning..."),u()},1e3)}),f.observe(document.body,{childList:!0,subtree:!0}),e("\u{1F441}\uFE0F Watching for DOM changes")}function h(){f&&(f.disconnect(),f=null)}function w(){return Array.from(o.values()).map(a=>({name:a.name,description:a.description,inputSchema:a.inputSchema,annotations:a.annotations}))}function N(){return{version:"0.1.0",site:window.location.origin,generatedAt:new Date().toISOString(),generatedBy:"webmcp-auto",tools:w()}}function E(){h();let a=r();a&&a.clearTools&&a.clearTools(),o.clear(),n=0,e("\u{1F5D1}\uFE0F All tools unregistered")}return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{u(),b()}):(u(),b()),{scan:u,getTools:w,getToolManifest:N,destroy:E,stopWatching:h}}if(typeof window<"u"){let t=document.currentScript;if(t&&t.getAttribute("data-auto")!=="false"){let o={};t.getAttribute("data-prefix")&&(o.prefix=t.getAttribute("data-prefix")),t.getAttribute("data-exclude")&&(o.exclude=t.getAttribute("data-exclude").split(",")),t.getAttribute("data-max-tools")&&(o.maxTools=parseInt(t.getAttribute("data-max-tools"),10)),t.getAttribute("data-debug")==="false"&&(o.debug=!1),window.__webmcpAuto=k(o)}}var B=k;return D(U);})();
